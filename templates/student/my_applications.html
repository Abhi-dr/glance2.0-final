{% extends 'student/base.html' %}
{% load static %}

{% block title %}
Student -> My Applications
{% endblock %}


{% block body %}

<div class="container-fluid">

  {% for message in messages %}

  <div class="alert alert-warning alert-dismissible fade show" role="alert">
    <strong>{{ message.tag }}</strong> {{ message }}
    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
  </div>

  {% endfor %}

  <div class="card">
    <div class="card-body">
      <h5 class="card-title fw-semibold mb-3">My Applications</h5>
      <p class="mb-0">Good to see you here! </p>
    </div>
  </div>

  <div class="row row-cols-1 row-cols-md-3 g-4">

    {% if applications %}

    <div class="row">
      {% for application in applications %}
      <div class="col-lg-6 mb-4">
        <div class="card h-100 border-0 shadow">
          <div class="card-header d-flex justify-content-between align-items-center bg-primary text-white">
            <h5 class="m-0">{{application.job.job_title}} - {{application.job.company.name}}</h5>
            <span class="badge rounded-pill 
            {% if application.status == 'Applied' %}bg-info
            {% elif application.status == 'In Review' %}bg-warning
            {% elif application.status == 'Selected' %}bg-success
            {% elif application.status == 'Rejected' %}bg-danger
            {% else %}bg-secondary{% endif %}">
              {{application.status}}
            </span>
          </div>
          <div class="card-body">
            <p class="card-text"><strong>Applied On:</strong> {{application.application_date|date:"d M Y"}}</p>
            <p class="card-text"><strong>Description:</strong> {{application.job.job_description|truncatewords:30}}</p>
            <p class="card-text"><strong>Skills Required:</strong> {{application.job.skills_required}}</p>
            <p class="card-text"><strong>Job Type:</strong> {{application.job.job_type}}</p>
            <p class="card-text"><strong>Location:</strong> {{application.job.location}}</p>
            <p class="card-text"><strong>Salary:</strong> â‚¹{{application.job.salary}}</p>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>

    <!-- Pagination -->
    <div class="row mt-4">
      <div class="col-12">
        <nav aria-label="Page navigation">
          <ul class="pagination justify-content-center">
            {% if applications.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?page=1" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" href="?page={{ applications.previous_page_number }}" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            {% else %}
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="First">
                <span aria-hidden="true">&laquo;&laquo;</span>
              </a>
            </li>
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Previous">
                <span aria-hidden="true">&laquo;</span>
              </a>
            </li>
            {% endif %}
            
            {% for i in applications.paginator.page_range %}
            {% if applications.number == i %}
            <li class="page-item active"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
            {% elif i > applications.number|add:'-3' and i < applications.number|add:'3' %}
            <li class="page-item"><a class="page-link" href="?page={{ i }}">{{ i }}</a></li>
            {% endif %}
            {% endfor %}
            
            {% if applications.has_next %}
            <li class="page-item">
              <a class="page-link" href="?page={{ applications.next_page_number }}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
            <li class="page-item">
              <a class="page-link" href="?page={{ applications.paginator.num_pages }}" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
              </a>
            </li>
            {% else %}
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
              </a>
            </li>
            <li class="page-item disabled">
              <a class="page-link" href="#" aria-label="Last">
                <span aria-hidden="true">&raquo;&raquo;</span>
              </a>
            </li>
            {% endif %}
          </ul>
        </nav>
      </div>
    </div>

    {% else %}

    <div class="col-lg-12">
      <h5 class="card-title fs-6 fw-semibold mb-3 text-danger">NO APPLICATION FOUND! Apply SOON!</h5>

      <a href="{% url 'all_jobs' %}" class="btn btn-primary w-100 btn-lg">Apply Now</a>

      {% endif %}
    </div>

      <!-- <div class="col-md-3">
      <h5 class="card-title fw-semibold mb-4">Purchased</h5>
      <div class="card">
        <img src="{% static 'img/dashboard/images/products/s1.jpg' %}" class="card-img-top" alt="...">
        <div class="card-body">
          <h5 class="card-title">Class 10th Course</h5>
          <p class="card-text">Keep your study ongoing with us.</p>
          <a href="#" class="btn btn-primary">Resume</a>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <h5 class="card-title fw-semibold mb-4">Purchased</h5>
      <div class="card">
        <img src="{% static 'img/dashboard/images/products/s5.jpg' %}" class="card-img-top" alt="...">
        <div class="card-body">
          <h5 class="card-title">Class 11th Course</h5>
          <p class="card-text">Keep your study ongoing with us.</p>
          <a href="#" class="btn btn-primary">Resume</a>
        </div>
      </div>
    </div>

    <div class="col-md-3">
      <h5 class="card-title fw-semibold mb-4">Purchased</h5>
      <div class="card">
        <img src="{% static 'img/dashboard/images/products/s7.jpg' %}" class="card-img-top" alt="...">
        <div class="card-body">
          <h5 class="card-title">Class 12th Course</h5>
          <p class="card-text">Keep your study ongoing with us.</p>
          <a href="#" class="btn btn-primary">Resume</a>
        </div>
      </div>
    </div> -->

    </div>

  </div>

  {% endblock %}